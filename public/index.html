<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<title>Авторизация</title>
	<link rel="stylesheet" href="css/style.css">
	<link rel="icon" href="http://vladmaxi.net/favicon.ico" type="image/x-icon">
	<link rel="shortcut icon" href="http://vladmaxi.net/favicon.ico" type="image/x-icon">
</head>
<body>
  <form method="post" class="login">
    <p>
      <label for="login">Логин:</label>
      <input type="text" name="login" id="login" value="">
    </p>

    <p>
      <label for="password">Пароль:</label>
      <input type="password" name="password" id="password" value="">
    </p>

    <p class="login-submit">
      <button type="submit" class="login-button">Войти</button>
    </p>
    <p class="forgot-password"><a href="registration.html">Регистрация</a></p>
  </form>

  <script>
    const submitBtn = document.querySelector(".login-button");
    submitBtn.onclick = async function(e) {
      e.preventDefault();
      const user = {
        login: document.forms[0].elements["login"].value,
        password: document.forms[0].elements["password"].value,
      };

      const response = await fetch("/authorization/login", {
        method: "POST",
        headers: {
          'Content-Type': 'application/json;charset=utf-8'
        },
        body: JSON.stringify(user),
      });

      const result = await response.json();
      console.log(result.message);
      if(response.ok) {
        window.location.href = "/chat.html";
      }
    }
  </script>
</body>
</html>
